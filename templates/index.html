<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/static/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Predicción de Precios de Viviendas</title>
</head>
<body>
    <h1>Chatbot de Predicción de Precios de Viviendas</h1>

    <form id="predictForm">
        <label for="area">Área:</label>
        <input type="number" id="area" name="area" required><br><br>

        <label for="bedrooms">Habitaciones:</label>
        <input type="number" id="bedrooms" name="bedrooms" required><br><br>

        <label for="bathrooms">Baños:</label>
        <input type="number" id="bathrooms" name="bathrooms" required><br><br>

        <label for="stories">Plantas:</label>
        <input type="number" id="stories" name="stories" required><br><br>

        <label for="mainroad">Calle principal:</label>
        <input type="checkbox" id="mainroad" name="mainroad" value="1"><br><br>

        <label for="guestroom">Habitación de invitados:</label>
        <input type="checkbox" id="guestroom" name="guestroom" value="1"><br><br>

        <label for="basement">Sótano:</label>
        <input type="checkbox" id="basement" name="basement" value="1"><br><br>

        <label for="hotwaterheating">Agua caliente:</label>
        <input type="checkbox" id="hotwaterheating" name="hotwaterheating" value="1"><br><br>

        <label for="airconditioning">Aire acondicionado:</label>
        <input type="checkbox" id="airconditioning" name="airconditioning" value="1"><br><br>

        <label for="parking">Plazas de aparcamiento:</label>
        <input type="number" id="parking" name="parking" required><br><br>

        <label for="prefarea">Área de preferencia:</label>
        <input type="checkbox" id="prefarea" name="prefarea" value="1"><br><br>

        <label for="furnished">Amueblado:</label>
        <input type="checkbox" id="furnished" name="furnished" value="1"><br><br>

        <button type="submit">Predecir Precio</button>
    </form>

    <h2 id="result"></h2>

    <script>
        document.getElementById("predictForm").onsubmit = async function(event) {
            event.preventDefault();
            let formData = new FormData(event.target);
            let formObject = {};
            formData.forEach((value, key) => { formObject[key] = value || 0 });

            let response = await fetch('/predict', {
                method: 'POST',
                body: new URLSearchParams(formObject)
            });

            let result = await response.json();
            document.getElementById("result").innerText = result.price
                ? `Precio estimado: ${result.price} unidades`
                : `Error: ${result.error}`;
        };
    </script>
</body>
</html>
